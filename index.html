<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>International Football League Playoff Predictor</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans&display=swap');
  body {
    font-family: 'Noto Sans', sans-serif;
    background: #0e1111;
    color: white;
    margin: 0 auto;
    max-width: 900px;
    padding: 1rem 1rem 3rem;
  }
  header {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
    gap: 0.75rem;
  }
  header img {
    width: 48px;
    height: 48px;
  }
  header h1 {
    font-family: 'Bebas Neue', cursive;
    font-size: 2.5rem;
    margin: 0;
  }
  h2 {
    font-family: 'Bebas Neue', cursive;
    font-size: 1.8rem;
    margin-top: 2rem;
    margin-bottom: 0.5rem;
  }
  h3 {
    font-family: 'Bebas Neue', cursive;
    font-size: 1.2rem;
    margin: 1rem 0 0.4rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  h3 img {
    width: 30px;
    height: 30px;
  }
  p.body-text {
    font-size: 0.95rem;
    margin-top: 0;
    margin-bottom: 1rem;
    color: #ccc;
  }

  /* Stage 1 Team Grid */
  .team-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.9rem;
  }
  .team-card {
    position: relative;
    width: 140px;
    height: 40px;
    background-color: #1a1a1a;
    border-radius: 6px;
    cursor: pointer;
    overflow: hidden;
    transition: background-color 0.2s ease, transform 0.2s ease;
  }
  .team-card img {
    width: 140px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
  }
  .team-card .label {
    position: absolute;
    top: 0;
    left: 0;
    width: 140px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: white;
    text-shadow: 0 0 4px #000, 0 0 6px #000;
    pointer-events: none;
    user-select: none;
    font-size: 0.9rem;
  }
  .team-card:hover:not(.disabled):not(.selected) {
    background-color: #292929;
    transform: scale(1.05);
  }
  .team-card.selected {
    outline: 3px solid #00bfff;
    background-color: #004466;
  }
  .team-card.disabled {
    filter: grayscale(90%) brightness(0.5);
    cursor: not-allowed;
  }

  /* Buttons */
  button {
    margin: 2rem auto 0 auto;
    display: block;
    padding: 0.8rem 1.8rem;
    font-size: 1.1rem;
    border-radius: 6px;
    border: none;
    background-color: #007bff;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:disabled {
    background-color: #444;
    cursor: not-allowed;
  }
  button:hover:not(:disabled) {
    background-color: #005bb5;
  }

  /* Stage 2 Bracket Styles */
  #stage2 {
    display: none;
    margin-top: 2rem;
  }
  .bracket {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
  }
  .round {
    background: #1a1a1a;
    padding: 1rem;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .round h2 {
    font-family: 'Bebas Neue', cursive;
    font-size: 1.5rem;
    margin-bottom: 1rem;
  }
  .matchup {
    border: 2px solid #444;
    border-radius: 8px;
    padding: 0.8rem;
    margin-bottom: 1.5rem;
    width: 100%;
    background: #222;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  .matchup .team-option {
    background-color: #333;
    padding: 0.5rem;
    border-radius: 6px;
    cursor: pointer;
    text-align: center;
    font-weight: bold;
    color: white;
    user-select: none;
    transition: background-color 0.2s ease;
  }
  .matchup .team-option:hover:not(.disabled):not(.selected) {
    background-color: #005580;
  }
  .team-option.selected {
    background-color: #007bff;
    cursor: default;
  }
  .team-option.disabled {
    background-color: #555;
    cursor: not-allowed;
    color: #bbb;
  }

  #worldbowl-container {
    grid-column: 4 / 5;
    display: flex;
    justify-content: center;
    margin-top: 0.5rem;
  }
  #worldbowl-logo {
    width: 80px;
    height: 80px;
  }

  #champion {
    background-color: #004466;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    font-weight: bold;
    font-size: 1.3rem;
    color: #00bfff;
    min-height: 70px;
  }

  @media (max-width: 600px) {
    body {
      max-width: 100%;
      padding: 1rem;
    }
    .team-card {
      width: 100px;
      height: 30px;
    }
    .team-card img,
    .team-card .label {
      width: 100px;
      height: 30px;
      font-size: 0.75rem;
    }
    .bracket {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
    .round {
      width: 100%;
      align-items: stretch;
    }
    #worldbowl-container {
      grid-column: auto;
      justify-content: center;
      margin-top: 1rem;
    }
  }
</style>
</head>
<body>

<header>
  <img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/ifl-logo_q9fmai.png" alt="IFL Logo" />
  <h1>International Football League Playoff Predictor</h1>
</header>

<section id="stage1">
  <h2>Division Winners</h2>
  <p class="body-text">Select 1 division winner from each division</p>

  <section class="division-section">
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-east_dzwpw9.png" alt="World East" /> World East</h3>
    <div class="team-grid" id="div-world-east"></div>
  </section>

  <section class="division-section">
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-central_okus8o.png" alt="World Central" /> World Central</h3>
    <div class="team-grid" id="div-world-central"></div>
  </section>

  <section class="division-section">
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-west_ie8gga.png" alt="World West" /> World West</h3>
    <div class="team-grid" id="div-world-west"></div>
  </section>

  <h2 style="margin-top: 3rem;">Wildcards</h2>
  <p class="body-text">Select 5 wildcard teams</p>
  <div class="team-grid" id="wildcards"></div>

  <button id="toStage2" disabled>Continue to Matchups</button>
</section>

<section id="stage2" style="display:none;">
  <h2>Bracket Builder</h2>
  <div class="bracket">
    <div class="round" id="quarterfinals">
      <h2>Quarter Finals</h2>
      <!-- Matchups go here -->
    </div>
    <div class="round" id="semifinals">
      <h2>Semi Finals</h2>
      <!-- Matchups go here -->
    </div>
    <div class="round" id="finals">
      <h2>Final</h2>
      <div class="matchup" id="final-matchup"></div>
      <div id="worldbowl-container">
        <img id="worldbowl-logo" src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752185315/WBIII_id02n2.png" alt="World Bowl Logo" />
      </div>
    </div>
    <div class="round" id="champion">
      <h2>Champion</h2>
      <div id="champion-name">No champion selected</div>
    </div>
  </div>
</section>

<script>
  // Data Setup
  const divisions = {
    "World East": [
      "Australia Whites",
      "Italia Bulls",
      "Belarus Barbarians",
      "Singapore Smelters",
      "South Korea Deers",
      "Poland Panthers",
    ],
    "World Central": [
      "Germany Cavaliers",
      "UK 3 Lions",
      "Finland Frigate",
      "Belgium Bulldogs",
      "Holland Hornets",
      "South Africa Silverbacks",
    ],
    "World West": [
      "USA Drones",
      "Jamaica Thunder",
      "Rwanda Raiders",
      "Egypt Pharaohs",
      "Peru Piranhas",
      "Brazil Hummingbirds",
    ],
  };

  // Track selections
  const divisionWinners = {
    "World East": null,
    "World Central": null,
    "World West": null,
  };
  const wildcardSelected = new Set();

  // Buttons
  const toStage2Btn = document.getElementById("toStage2");

  // Helper to create a team card with image and label
  function createTeamCard(teamName) {
    const card = document.createElement("div");
    card.classList.add("team-card");
    const img = document.createElement("img");
    // Use the cloudinary URLs
    const logos = {
      "Australia Whites": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182184/australia-whites_h9o2vz.png",
      "Italia Bulls": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/italia-bulls_aocvis.png",
      "Belarus Barbarians": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/belarus-barbarians_ydx3kz.png",
      "Singapore Smelters": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/singapore-smelters_qn3ges.png",
      "South Korea Deers": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/southkorea-deers_jbt02f.png",
      "Poland Panthers": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/poland-panthers_ppg3zr.png",
      "Germany Cavaliers": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/germany-cavaliers_qrcojc.png",
      "UK 3 Lions": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/uk-tri-lions_kyixfr.png",
      "Finland Frigate": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/finland-frigate_u7rjbj.png",
      "Belgium Bulldogs": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/belgium-bulldogs_hrx8td.png",
      "Holland Hornets": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/holland-hornets_ilzroo.png",
      "South Africa Silverbacks": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/southafrica-silverbaks_x6but2.png",
      "USA Drones": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182187/usa-drones_doeba8.png",
      "Jamaica Thunder": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/jamaica-thunder_ogo7aj.png",
      "Rwanda Raiders": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/rwanda-raiders_aqtgu7.png",
      "Egypt Pharaohs": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/egypt-pharaohs_ycglpl.png",
      "Peru Piranhas": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/peru-piranhas_yueas6.png",
      "Brazil Hummingbirds": "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/brazil-hummingbirds_dras9r.png",
    };
    img.src = logos[teamName] || "";
    img.alt = teamName;
    card.appendChild(img);
    const label = document.createElement("div");
    label.classList.add("label");
    label.textContent = teamName;
    card.appendChild(label);
    return card;
  }

  // Render Division Winners Team Grids
  function renderDivisionWinners() {
    // Clear containers
    Object.entries(divisions).forEach(([divName, teams]) => {
      const container = document.getElementById("div-" + divName.toLowerCase().replace(" ", "-"));
      container.innerHTML = "";
      teams.forEach((team) => {
        const card = createTeamCard(team);
        // Disable if selected as winner in another division or selected here already
        if (
          Object.values(divisionWinners).includes(team) &&
          divisionWinners[divName] !== team
        ) {
          card.classList.add("disabled");
        }
        // If selected, mark as selected
        if (divisionWinners[divName] === team) {
          card.classList.add("selected");
        }
        card.addEventListener("click", () => {
          if (divisionWinners[divName] === team) {
            divisionWinners[divName] = null;
          } else {
            divisionWinners[divName] = team;
            // Remove wildcard if selected here
            if (wildcardSelected.has(team)) {
              wildcardSelected.delete(team);
            }
          }
          renderDivisionWinners();
          renderWildcards();
          updateContinueButton();
        });
        container.appendChild(card);
      });
    });
  }

  // Render Wildcards
  function renderWildcards() {
    const wcContainer = document.getElementById("wildcards");
    wcContainer.innerHTML = "";
    // Eligible wildcard teams = all teams excluding division winners selected
    let allTeams = [];
    Object.values(divisions).forEach((arr) => (allTeams = allTeams.concat(arr)));
    const divisionWinnerTeams = Object.values(divisionWinners).filter(Boolean);
    const eligibleWildcards = allTeams.filter((team) => !divisionWinnerTeams.includes(team));

    eligibleWildcards.forEach((team) => {
      const card = createTeamCard(team);
      if (wildcardSelected.has(team)) {
        card.classList.add("selected");
      }
      card.addEventListener("click", () => {
        if (wildcardSelected.has(team)) {
          wildcardSelected.delete(team);
        } else if (wildcardSelected.size < 5) {
          wildcardSelected.add(team);
        }
        renderWildcards();
        updateContinueButton();
      });
      wcContainer.appendChild(card);
    });
  }

  // Enable continue button if conditions met
  function updateContinueButton() {
    const winnersSelected = Object.values(divisionWinners).filter(Boolean).length === 3;
    const wildcardsSelected = wildcardSelected.size === 5;
    toStage2Btn.disabled = !(winnersSelected && wildcardsSelected);
  }

  // STAGE 2 Variables
  const stage2 = document.getElementById("stage2");
  const stage1 = document.getElementById("stage1");
  const quarterfinals = document.getElementById("quarterfinals");
  const semifinals = document.getElementById("semifinals");
  const finals = document.getElementById("finals");
  const championSection = document.getElementById("champion-name");

  // Hold selections for brackets
  let quarterWinners = new Array(8).fill(null);
  let semiWinners = new Array(4).fill(null);
  let finalWinner = null;

  // On Continue button click: Build quarterfinals bracket
  toStage2Btn.addEventListener("click", () => {
    stage1.style.display = "none";
    stage2.style.display = "block";
    buildQuarterfinals();
  });

  // Build Quarterfinals: 8 teams = 3 division winners + 5 wildcards
  function buildQuarter
