<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IFL Playoff Predictor</title>
<style>
  body {
    background: #0e1111;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 1000px;
    margin: 1rem auto;
    padding: 1rem;
  }
  h1 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 700;
    font-size: 1.8rem;
    margin-bottom: 1rem;
  }
  h1 img {
    width: 40px;
    height: 40px;
  }
  .stage {
    margin-bottom: 3rem;
  }
  h2 {
    font-weight: 700;
    font-size: 1.4rem;
    margin-bottom: 0.2rem;
  }
  h3 {
    font-weight: 600;
    font-size: 1.1rem;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  h3 img {
    width: 25px;
    height: 25px;
  }
  .body-text {
    font-weight: 400;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    color: #ccc;
  }
  .team-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .team-card {
    cursor: pointer;
    width: 140px;
    height: 40px;
    background-color: #1a1a1a;
    border-radius: 6px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    color: white;
    user-select: none;
    transition: background-color 0.2s, transform 0.2s;
  }
  .team-card:hover:not(.disabled) {
    background-color: #333;
    transform: scale(1.05);
  }
  .team-card.selected {
    outline: 3px solid #00bfff;
    background-color: #005f9e;
  }
  .team-card.disabled {
    opacity: 0.4;
    cursor: default;
    pointer-events: none;
  }
  button {
    display: block;
    margin: 2rem auto 0;
    padding: 0.8rem 2rem;
    font-weight: 600;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    background-color: #007bff;
    color: white;
    cursor: pointer;
  }
  button:disabled {
    background-color: #555;
    cursor: default;
  }
  /* Stage 2 bracket simple style */
  #stage2 {
    display: none;
  }
  .bracket {
    display: flex;
    justify-content: center;
    gap: 40px;
    flex-wrap: wrap;
  }
  .round {
    background: #1a1a1a;
    padding: 1rem;
    border-radius: 8px;
    min-width: 140px;
    text-align: center;
  }
  .round h3 {
    margin-bottom: 1rem;
  }
  .matchup {
    background: #222;
    border-radius: 5px;
    margin-bottom: 1rem;
    padding: 0.5rem;
    cursor: pointer;
    font-weight: 600;
  }
  .matchup.selected {
    background-color: #007bff;
  }
</style>
</head>
<body>
<h1><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/ifl-logo_q9fmai.png" alt="IFL Logo" />International Football League Playoff Predictor</h1>

<div id="stage1" class="stage">
  <h2>Division Winners</h2>
  <div class="body-text">Select 1 division winner from each division</div>

  <div>
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-east_dzwpw9.png" alt="World East" />World East</h3>
    <div id="div-world-east" class="team-grid"></div>
  </div>

  <div>
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-central_okus8o.png" alt="World Central" />World Central</h3>
    <div id="div-world-central" class="team-grid"></div>
  </div>

  <div>
    <h3><img src="https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-west_ie8gga.png" alt="World West" />World West</h3>
    <div id="div-world-west" class="team-grid"></div>
  </div>

  <h2>Wildcards</h2>
  <div class="body-text">Select 5 wildcard teams</div>
  <div id="wildcards" class="team-grid"></div>

  <button id="toStage2" disabled>Continue to Matchups</button>
</div>

<div id="stage2" class="stage">
  <h2>Playoff Bracket</h2>
  <div class="bracket">
    <div class="round" id="quarterfinals">
      <h3>Quarter Finals</h3>
    </div>
    <div class="round" id="semifinals">
      <h3>Semi Finals</h3>
    </div>
    <div class="round" id="final">
      <h3>Final</h3>
    </div>
    <div class="round" id="champion">
      <h3>Champion</h3>
      <div id="champion-name" style="margin-top: 1rem; font-weight: bold; font-size: 1.2rem;"></div>
    </div>
  </div>
</div>

<script>
  const divisions = {
    "World East": ["Australia Whites", "Italia Bulls", "Belarus Barbarians", "Singapore Smelters", "South Korea Deers", "Poland Panthers"],
    "World Central": ["Germany Cavaliers", "UK 3 Lions", "Finland Frigate", "Belgium Bulldogs", "Holland Hornets", "South Africa Silverbacks"],
    "World West": ["USA Drones", "Jamaica Thunder", "Rwanda Raiders", "Egypt Pharaohs", "Peru Piranhas", "Brazil Hummingbirds"]
  };

  const divisionWinners = {
    "World East": null,
    "World Central": null,
    "World West": null
  };
  const wildcardSelected = new Set();

  const toStage2Btn = document.getElementById("toStage2");

  function renderDivisionWinners() {
    for (const [division, teams] of Object.entries(divisions)) {
      const container = document.getElementById("div-" + division.toLowerCase().replace(/ /g, "-"));
      container.innerHTML = "";
      teams.forEach(team => {
        const card = document.createElement("div");
        card.className = "team-card";
        card.textContent = team;

        // Disable if selected as division winner in other divisions
        const selectedElsewhere = Object.entries(divisionWinners).some(([div, t]) => div !== division && t === team);
        if (selectedElsewhere) card.classList.add("disabled");

        if (divisionWinners[division] === team) card.classList.add("selected");

        card.onclick = () => {
          if (divisionWinners[division] === team) {
            divisionWinners[division] = null;
          } else {
            divisionWinners[division] = team;
            // Remove from wildcard if present
            if (wildcardSelected.has(team)) wildcardSelected.delete(team);
          }
          renderAllStage1();
        };

        container.appendChild(card);
      });
    }
  }

  function renderWildcards() {
    const container = document.getElementById("wildcards");
    container.innerHTML = "";
    const allTeams = Object.values(divisions).flat();
    const divisionWinnerTeams = Object.values(divisionWinners).filter(Boolean);
    const eligible = allTeams.filter(t => !divisionWinnerTeams.includes(t));
    eligible.forEach(team => {
      const card = document.createElement("div");
      card.className = "team-card";
      card.textContent = team;

      if (wildcardSelected.has(team)) card.classList.add("selected");

      card.onclick = () => {
        if (wildcardSelected.has(team)) {
          wildcardSelected.delete(team);
        } else if (wildcardSelected.size < 5) {
          wildcardSelected.add(team);
        }
        renderAllStage1();
      };

      container.appendChild(card);
    });
  }

  function updateContinueButton() {
    const winnersCount = Object.values(divisionWinners).filter(t => t !== null).length;
    toStage2Btn.disabled = !(winnersCount === 3 && wildcardSelected.size === 5);
  }

  function renderAllStage1() {
    renderDivisionWinners();
    renderWildcards();
    updateContinueButton();
  }

  renderAllStage1();

  // Stage 2 Logic

  const stage1 = document.getElementById("stage1");
  const stage2 = document.getElementById("stage2");

  const quarterfinals = document.getElementById("quarterfinals");
  const semifinals = document.getElementById("semifinals");
  const final = document.getElementById("final");
  const champion = document.getElementById("champion-name");

  // Hold selections in stage 2
  let quarterFinalWinners = [];
  let semiFinalWinners = [];
  let finalWinner = null;

  // Helper to create matchup div
  function createMatchup(teamName) {
    const div = document.createElement("div");
    div.className = "matchup";
    div.textContent = teamName;
    return div;
  }

  // Render stage 2 quarterfinals (the 8 teams)
  function renderQuarterfinals(teams) {
    quarterfinals.innerHTML = "<h3>Quarter Finals</h3>";
    teams.forEach(team => {
      const matchDiv = createMatchup(team);
      matchDiv.onclick = () => {
        if (quarterFinalWinners.includes(team)) {
          quarterFinalWinners = quarterFinalWinners.filter(t => t !== team);
          renderSemifinals();
          renderFinal();
          renderChampion();
          matchDiv.classList.remove("selected");
        } else if (quarterFinalWinners.length < 4) {
          quarterFinalWinners.push(team);
          renderSemifinals();
          renderFinal();
          renderChampion();
          matchDiv.classList.add("selected");
        }
      };
      if (quarterFinalWinners.includes(team)) matchDiv.classList.add("selected");
      quarterfinals.appendChild(matchDiv);
    });
  }

  function renderSemifinals() {
    semifinals.innerHTML = "<h3>Semi Finals</h3>";
    semiFinalWinners = semiFinalWinners.filter(team => quarterFinalWinners.includes(team));
    const semiTeams = quarterFinalWinners;
    semiTeams.forEach(team => {
      const matchDiv = createMatchup(team);
      matchDiv.onclick = () => {
        if (semiFinalWinners.includes(team)) {
          semiFinalWinners = semiFinalWinners.filter(t => t !== team);
          renderFinal();
          renderChampion();
          matchDiv.classList.remove("selected");
        } else if (semiFinalWinners.length < 2) {
          semiFinalWinners.push(team);
          renderFinal();
          renderChampion();
          matchDiv.classList.add("selected");
        }
      };
      if (semiFinalWinners.includes(team)) matchDiv.classList.add("selected");
      semifinals.appendChild(matchDiv);
    });
  }

  function renderFinal() {
    final.innerHTML = "<h3>Final</h3>";
    finalWinner = (finalWinner && semiFinalWinners.includes(finalWinner)) ? finalWinner : null;
    semiFinalWinners.forEach(team => {
      const matchDiv = createMatchup(team);
      matchDiv.onclick = () => {
        if (finalWinner === team) {
          finalWinner = null;
          renderChampion();
          matchDiv.classList.remove("selected");
        } else {
          finalWinner = team;
          renderChampion();
          // Remove selection from other teams in final
          Array.from(final.children)
            .filter(c => c.classList && c.classList.contains("matchup"))
            .forEach(c => c.classList.remove("selected"));
          matchDiv.classList.add("selected");
        }
      };
      if (finalWinner === team) matchDiv.classList.add("selected");
      final.appendChild(matchDiv);
    });
  }

  function renderChampion() {
    champion.textContent = finalWinner ? finalWinner : "";
  }

  toStage2Btn.onclick = () => {
    const divisionWinnerTeams = Object.values(divisionWinners).filter(Boolean);
    if (divisionWinnerTeams.length !== 3 || wildcardSelected.size !== 5) {
      alert("Please select exactly 3 division winners and 5 wildcard teams");
      return;
    }
    stage1.style.display = "none";
    stage2.style.display = "block";

    const allPlayoffTeams = [...divisionWinnerTeams, ...wildcardSelected];
    quarterFinalWinners = [];
    semiFinalWinners = [];
    finalWinner = null;
    renderQuarterfinals(allPlayoffTeams);
    renderSemifinals();
    renderFinal();
    renderChampion();
  };
</script>
</body>
</html>
