<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IFL Playoff Predictor</title>
<style>
  body {
    background: #0e1111;
    color: white;
    font-family: Arial, sans-serif;
    max-width: 900px;
    margin: 0 auto;
    padding: 1rem;
  }
  h1, h2 {
    font-weight: bold;
  }
  .team-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.7rem;
    margin-bottom: 1rem;
  }
  .team-card {
    cursor: pointer;
    border-radius: 6px;
    padding: 0.5rem 1rem;
    background: #222;
    user-select: none;
    min-width: 120px;
    text-align: center;
    transition: background-color 0.3s;
  }
  .team-card.selected {
    background-color: #007bff;
  }
  .team-card.disabled {
    background-color: #444;
    cursor: not-allowed;
    color: #999;
  }
  #toStage2 {
    margin-top: 1rem;
    padding: 0.6rem 1.5rem;
    font-size: 1rem;
    cursor: pointer;
  }
  #toStage2:disabled {
    background: #555;
    cursor: not-allowed;
  }
  #stage2 {
    display: none;
  }
  /* Simple bracket style */
  .bracket {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }
  .round {
    background: #111;
    padding: 1rem;
    border-radius: 8px;
  }
  .round h2 {
    margin-top: 0;
    margin-bottom: 1rem;
  }
  .matchup {
    background: #222;
    margin-bottom: 1rem;
    padding: 0.5rem;
    border-radius: 6px;
  }
  .team-option {
    padding: 0.3rem;
    margin: 0.2rem 0;
    cursor: pointer;
    border-radius: 4px;
    background: #333;
  }
  .team-option.selected {
    background-color: #007bff;
    color: white;
    cursor: default;
  }
  .team-option.disabled {
    background-color: #555;
    cursor: not-allowed;
    color: #999;
  }
  #champion-name {
    margin-top: 1rem;
    font-weight: bold;
    font-size: 1.3rem;
    text-align: center;
    color: #0bf;
  }
</style>
</head>
<body>

<h1>International Football League Playoff Predictor</h1>

<section id="stage1">
  <h2>Division Winners</h2>
  <p>Select 1 division winner from each division</p>
  
  <div>
    <h3>World East</h3>
    <div id="div-world-east" class="team-grid"></div>
  </div>
  <div>
    <h3>World Central</h3>
    <div id="div-world-central" class="team-grid"></div>
  </div>
  <div>
    <h3>World West</h3>
    <div id="div-world-west" class="team-grid"></div>
  </div>

  <h2>Wildcards</h2>
  <p>Select 5 wildcard teams</p>
  <div id="wildcards" class="team-grid"></div>

  <button id="toStage2" disabled>Continue to Matchups</button>
</section>

<section id="stage2">
  <h2>Bracket Builder</h2>
  <div class="bracket">
    <div class="round" id="quarterfinals">
      <h2>Quarter Finals</h2>
    </div>
    <div class="round" id="semifinals">
      <h2>Semi Finals</h2>
    </div>
    <div class="round" id="finals">
      <h2>Final</h2>
    </div>
    <div class="round" id="champion">
      <h2>Champion</h2>
      <div id="champion-name">No champion selected</div>
    </div>
  </div>
</section>

<script>
  const divisions = {
    "World East": ["Australia Whites", "Italia Bulls", "Belarus Barbarians", "Singapore Smelters", "South Korea Deers", "Poland Panthers"],
    "World Central": ["Germany Cavaliers", "UK 3 Lions", "Finland Frigate", "Belgium Bulldogs", "Holland Hornets", "South Africa Silverbacks"],
    "World West": ["USA Drones", "Jamaica Thunder", "Rwanda Raiders", "Egypt Pharaohs", "Peru Piranhas", "Brazil Hummingbirds"]
  };

  let divisionWinners = {
    "World East": null,
    "World Central": null,
    "World West": null
  };
  let wildcardSelected = new Set();

  const toStage2Btn = document.getElementById("toStage2");

  function updateContinueButton() {
    const winnersCount = Object.values(divisionWinners).filter(t => t !== null).length;
    toStage2Btn.disabled = !(winnersCount === 3 && wildcardSelected.size === 5);
  }

  function renderDivisionWinners() {
    for (const [division, teams] of Object.entries(divisions)) {
      const container = document.getElementById("div-" + division.toLowerCase().replace(" ", "-"));
      container.innerHTML = "";
      teams.forEach(team => {
        const card = document.createElement("div");
        card.className = "team-card";
        card.textContent = team;
        // Disable if selected in other division winners
        const isSelectedElsewhere = Object.entries(divisionWinners).some(([div, t]) => div !== division && t === team);
        if (isSelectedElsewhere) card.classList.add("disabled");
        if (divisionWinners[division] === team) card.classList.add("selected");
        card.onclick = () => {
          if (divisionWinners[division] === team) {
            divisionWinners[division] = null;
          } else {
            divisionWinners[division] = team;
            if (wildcardSelected.has(team)) wildcardSelected.delete(team);
          }
          renderDivisionWinners();
          renderWildcards();
          updateContinueButton();
        };
        container.appendChild(card);
      });
    }
  }

  function renderWildcards() {
    const container = document.getElementById("wildcards");
    container.innerHTML = "";
    // Eligible wildcards = all teams not selected as division winners
    const allTeams = Object.values(divisions).flat();
    const divisionWinnerTeams = Object.values(divisionWinners).filter(Boolean);
    const eligible = allTeams.filter(t => !divisionWinnerTeams.includes(t));
    eligible.forEach(team => {
      const card = document.createElement("div");
      card.className = "team-card";
      card.textContent = team;
      if (wildcardSelected.has(team)) card.classList.add("selected");
      card.onclick = () => {
        if (wildcardSelected.has(team)) {
          wildcardSelected.delete(team);
        } else if (wildcardSelected.size < 5) {
          wildcardSelected.add(team);
        }
        renderWildcards();
        updateContinueButton();
      };
      container.appendChild(card);
    });
  }

  // Initial render
  renderDivisionWinners();
  renderWildcards();
  updateContinueButton();

  // STAGE 2 variables
  const stage1 = document.getElementById("stage1");
  const stage2 = document.getElementById("stage2");
  const quarterfinals = document.getElementById("quarterfinals");
  const semifinals = document.getElementById("semifinals");
  const finals = document.getElementById("finals");
  const championName = document.getElementById("champion-name");

  // Bracket selections
  let quarterWinners = new Array(8).fill(null);
  let semiWinners = new Array(4).fill(null);
  let finalWinner = null;

  // Helper to create matchup boxes with team options
  function createMatchupBox(index, round, teams, onSelect) {
    const matchup = document.createElement("div");
    matchup.className = "matchup";
    teams.forEach((team, i) => {
      const teamDiv = document.createElement("div");
      teamDiv.className = "team-option";
      teamDiv.textContent = team;
      // Disable if already selected in this matchup
      teamDiv.onclick = () => {
        onSelect(team);
      };
      matchup.appendChild(teamDiv);
    });
    return matchup;
  }

  function buildQuarterfinals() {
    quarterfinals.innerHTML = "<h2>Quarter Finals</h2>";
    // Combine division winners + wildcards
    const qTeams = [
      divisionWinners["World East"],
      divisionWinners["World Central"],
      divisionWinners["World West"],
      ...wildcardSelected
    ];
    // 8 teams needed, if less fill with placeholders
    while (qTeams.length < 8) qTeams.push("TBD");

    quarterWinners = new Array(8).fill(null);
    semiWinners = new Array(4).fill(null);
    finalWinner = null;
    championName.textContent = "No champion selected";
    semifinals.innerHTML = "<h2>Semi Finals</h2>";
    finals.innerHTML = "<h2>Final</h2>";
    renderQuarterfinals(qTeams);
    renderSemifinals();
    renderFinals();
  }

  function renderQuarterfinals(qTeams) {
    quarterfinals.innerHTML = "<h2>Quarter Finals</h2>";
    for (let i = 0; i < 8; i += 2) {
      const matchup = document.createElement("div");
      matchup.className = "matchup";
      [qTeams[i], qTeams[i + 1]].forEach(team => {
        const div = document.createElement("div");
        div.className = "team-option";
        div.textContent = team;
        if (quarterWinners[i] === team || quarterWinners[i + 1] === team) div.classList.add("selected");
        if (team === "TBD") div.classList.add("disabled");
        div.onclick = () => {
          if (team === "TBD") return;
          // Set winner for this matchup index
          quarterWinners[i / 2 * 2] = team;
          // Move to semis immediately:
          renderQuarterfinals(qTeams);
          renderSemifinals();
          renderFinals();
        };
        matchup.appendChild(div);
      });
      quarterfinals.appendChild(matchup);
    }
  }

  function renderSemifinals() {
    semifinals.innerHTML = "<h2>Semi Finals</h2>";
    let semiTeams = [];
    for (let i = 0; i < 8; i += 2) {
      semiTeams.push(quarterWinners[i] || "TBD");
    }
    for (let i = 0; i < 4; i += 2) {
      semiTeams.push(quarterWinners[i + 1] || "TBD");
    }
    // Actually semifinals are winners of quarterfinal pairs: quarterWinners[0,1], [2,3], etc
    const pairs = [
      [quarterWinners[0], quarterWinners[1]],
      [quarterWinners[2], quarterWinners[3]],
      [quarterWinners[4], quarterWinners[5]],
      [quarterWinners[6], quarterWinners[7]],
    ];

    semiWinners = new Array(4).fill(null);
    for (let i = 0; i < 4; i++) {
      const matchup = document.createElement("div");
      matchup.className = "matchup";
      pairs[i].forEach(team => {
        const div = document.createElement("div");
        div.className = "team-option";
        div.textContent = team || "TBD";
        if (semiWinners[i] === team) div.classList.add("selected");
        if (!team) div.classList.add("disabled");
        div.onclick = () => {
          if (!team) return;
          semiWinners[i] = team;
          renderSemifinals();
          renderFinals();
        };
        matchup.appendChild(div);
      });
      semifinals.appendChild(matchup);
    }
  }

  function renderFinals() {
    finals.innerHTML = "<h2>Final</h2>";
    const finalTeams = [
      semiWinners[0] || "TBD",
      semiWinners[1] || "TBD",
      semiWinners[2] || "TBD",
      semiWinners[3] || "TBD",
    ].slice(0, 2); // Final only has 2 teams: winners of first two semis

    finalWinner = null;
    const matchup = document.createElement("div");
    matchup.className = "matchup";
    finalTeams.forEach(team => {
      const div = document.createElement("div");
      div.className = "team-option";
      div.textContent = team;
      if (finalWinner === team) div.classList.add("selected");
      if (team === "TBD") div.classList.add("disabled");
      div.onclick = () => {
        if (team === "TBD") return;
        finalWinner = team;
        championName.textContent = `ðŸ† Champion: ${team}`;
        renderFinals();
      };
      matchup.appendChild(div);
    });
    finals.appendChild(matchup);

    if (!finalWinner) championName.textContent = "No champion selected";
  }

  // Button to start stage 2
  toStage2Btn.onclick = () => {
    stage1.style.display = "none";
    stage2.style.display = "block";
    buildQuarterfinals();
  };
</script>

</body>
</html>

